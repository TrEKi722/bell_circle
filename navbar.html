<nav class="navbar">
  <div class="navbar-content">
    <div class="navbar-left">
      <img class="navbar-logo" src="/Media/Logos/Logotype_LightPrimary.png" alt="Bell Circle Logo">
      <!-- <span class="navbar-logo-text">Bell Circle</span> -->
    </div>
    <button class="navbar-hamburger" aria-label="Open menu" tabindex="0">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <div class="navbar-links">
      <a href="../">Home</a>
      <a href="/avms">AVMS</a>
      <a href="/djams">DJAMS</a>
      <a href="/fnms">FNMS</a>
      <a href="/comingsoon">NHMS</a>
      <a href="/anhs">Aliso Niguel</a>
      <a href="/comingsoon">Dana Hills</a>
      <a href="/comingsoon">Tesoro</a>
      <div class="navbar-dropdown" tabindex="0">
        <span class="navbar-dropbtn">Other</span>
        <div class="navbar-dropdown-content">
          <!-- <a href="/blog">Blog</a> -->
          <a href="/feedback">Feedback</a>
          <a href="/change-log">Change Log</a>
          <a href="/privacy">Privacy Policy</a>
          <!-- <a href="/about">About</a> -->
        </div>
      </div>
      <div class="theme-toggle-container">
        <label class="switch">
          <input type="checkbox" id="themeToggle" name="themeToggle">
          <span class="slider round"></span>
        </label>
      </div>
    </div>
  </div>
  <!-- Sliding Hamburger Menu Drawer -->
  <div class="navbar-hamburger-menu">
    <a href="../">Home</a>
    <a href="/avms">AVMS</a>
    <a href="/djams">DJAMS</a>
    <a href="/fnms">FNMS</a>
    <a href="/nhms">NHMS</a>
    <a href="/anhs">Aliso Niguel</a>
    <a href="/dhhs">Dana Hills</a>
    <a href="/tesoro">Tesoro</a>
    <div class="navbar-dropdown">
      <span class="navbar-dropbtn">Other</span>
      <div class="navbar-dropdown-content">
        <a href="/blog">Blog</a>
        <a href="/feedback">Feedback</a>
        <a href="/change-log">Change Log</a>
        <a href="/privacy">Privacy Policy</a>
        <a href="/about">About</a>
      </div>
    </div>
    <div class="theme-toggle-container">
      <label class="switch">
        <input type="checkbox" id="themeToggleMobile" name="themeToggleMobile">
        <span class="slider round"></span>
      </label>
    </div>
  </div>
</nav>

<script>
  console.log('=== NAVBAR SCRIPT STARTING ===');
  
  // Theme functions - globally accessible
  window.getCurrentTheme = function() {
    const styleLink = document.querySelector('link[rel="stylesheet"]');
    console.log('Looking for stylesheet link...');
    console.log('All links on page:', document.querySelectorAll('link').length);
    
    // Try multiple selectors
    let link = styleLink || document.querySelector('link[href*="light.css"]') || document.querySelector('link[href*="dark.css"]');
    
    if (link) {
      const href = link.getAttribute('href');
      console.log('Current stylesheet href:', href);
      if (href.includes('dark.css')) {
        console.log('Theme detected: dark');
        return 'dark';
      }
    } else {
      console.log('No stylesheet link found at all!');
      console.log('All link elements:', Array.from(document.querySelectorAll('link')).map(l => l.getAttribute('href')));
    }
    
    const savedTheme = localStorage.getItem('theme') || 'light';
    console.log('Theme from localStorage:', savedTheme);
    return savedTheme;
  };
  
  window.applyTheme = function(theme) {
    console.log('=== APPLYING THEME:', theme, '===');
    
    // Try to find stylesheet with multiple selectors
    let styleLink = document.querySelector('link[rel="stylesheet"]');
    if (!styleLink) {
      styleLink = document.querySelector('link[href*="light.css"]') || document.querySelector('link[href*="dark.css"]');
    }
    
    if (!styleLink) {
      console.error('NO STYLESHEET LINK FOUND - checking all links:');
      Array.from(document.querySelectorAll('link')).forEach((link, i) => {
        console.log(`Link ${i}:`, link.getAttribute('rel'), link.getAttribute('href'));
      });
      return;
    }
    
    const href = styleLink.getAttribute('href');
    console.log('Current href:', href);
    let newHref = href;
    
    if (theme === 'dark') {
      newHref = href.replace(/light\.css/g, 'dark.css');
    } else {
      newHref = href.replace(/dark\.css/g, 'light.css');
    }
    
    console.log('New href will be:', newHref);
    
    if (newHref !== href) {
      console.log('Setting new href...');
      styleLink.setAttribute('href', newHref);
      console.log('Stylesheet changed successfully');
    } else {
      console.log('No change needed to href');
    }
    
    localStorage.setItem('theme', theme);
    console.log('Theme saved to localStorage:', theme);
    window.updateToggles(theme);
  };
  
  window.updateToggles = function(theme) {
    console.log('Updating toggle states for theme:', theme);
    const themeToggle = document.getElementById('themeToggle');
    const themeToggleMobile = document.getElementById('themeToggleMobile');
    
    console.log('themeToggle found:', !!themeToggle);
    console.log('themeToggleMobile found:', !!themeToggleMobile);
    
    const isDark = theme === 'dark';
    if (themeToggle) {
      themeToggle.checked = isDark;
      console.log('Desktop toggle set to:', isDark);
    }
    if (themeToggleMobile) {
      themeToggleMobile.checked = isDark;
      console.log('Mobile toggle set to:', isDark);
    }
  };
  
  // Initialize theme
  window.initThemeToggles = function() {
    console.log('=== INITIALIZING THEME TOGGLES ===');
    const themeToggle = document.getElementById('themeToggle');
    const themeToggleMobile = document.getElementById('themeToggleMobile');
    
    console.log('themeToggle element:', !!themeToggle);
    console.log('themeToggleMobile element:', !!themeToggleMobile);
    
    if (!themeToggle || !themeToggleMobile) {
      console.error('Theme toggle elements not found!');
      console.log('Checking for toggles with different selectors...');
      console.log('All checkboxes on page:', document.querySelectorAll('input[type="checkbox"]').length);
      Array.from(document.querySelectorAll('input[type="checkbox"]')).forEach((input, i) => {
        console.log(`Checkbox ${i}:`, input.id, input.name);
      });
      return;
    }
    
    // Initialize
    const currentTheme = window.getCurrentTheme();
    console.log('Current theme detected:', currentTheme);
    window.updateToggles(currentTheme);
    
    // Add listeners
    themeToggle.addEventListener('change', function() {
      console.log('Desktop toggle changed. Checked:', this.checked);
      const newTheme = this.checked ? 'dark' : 'light';
      window.applyTheme(newTheme);
      if (themeToggleMobile) themeToggleMobile.checked = this.checked;
    });
    
    themeToggleMobile.addEventListener('change', function() {
      console.log('Mobile toggle changed. Checked:', this.checked);
      const newTheme = this.checked ? 'dark' : 'light';
      window.applyTheme(newTheme);
      if (themeToggle) themeToggle.checked = this.checked;
    });
    
    console.log('=== INITIALIZATION COMPLETE ===');
  };
  
  // Run initialization immediately
  console.log('About to run initThemeToggles...');
  window.initThemeToggles();
</script>